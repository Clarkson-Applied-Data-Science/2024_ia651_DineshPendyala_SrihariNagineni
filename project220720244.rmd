---
title: "Untitled"
author: "Dinesh Kumar Pendyala"
date: "2024-07-22"
output: html_document
---

```{r}
library(ggpubr)
library(readr)
library(readxl)
library(ggplot2)
library(dplyr)
```

```{r}
library(tidyverse)

# Load the dataset
data <- read.csv("dataset_DM.csv")

# Run ANOVA test
anova_result <- aov(Age ~ as.factor(sub.type), data = data)

# Display the summary of the ANOVA test
summary(anova_result)
```
```{r}
data
```
```{r}
# Load necessary library
library(dplyr)

# Assuming your dataset is named `data`
data_summary <- list()

# Summarize numerical features
numerical_summary <- data %>%
  select(where(is.numeric)) %>%
  summary()

# Summarize categorical features
categorical_summary <- data %>%
  select(where(is.factor) | where(is.character)) %>%
  summarise_all(~ list(table(.)))

# Combine summaries
data_summary$numerical <- numerical_summary
data_summary$categorical <- categorical_summary

# Print summaries
print("Numerical Features Summary:")
print(data_summary$numerical)

print("Categorical Features Summary:")
print(data_summary$categorical)

```
```{r}
numerical_summary

```
```{r}



```







```{r}

# Get the names of all numerical columns
numeric_columns <- sapply(data, is.numeric)
numeric_columns <- names(data)[numeric_columns]

# Remove the "sub.type" column from numeric columns list
numeric_columns <- setdiff(numeric_columns, "sub.type")

# Run ANOVA for each numerical column and store the results in a list
anova_results <- lapply(numeric_columns, function(column) {
  formula <- as.formula(paste(column, "~ as.factor(AMItype)"))
  aov(formula, data = data)
})

# Display the summary of each ANOVA test
anova_summaries <- lapply(anova_results, summary)

# Print summaries
for (i in 1:length(anova_summaries)) {
  cat("ANOVA summary for", numeric_columns[i], ":\n")
  print(anova_summaries[[i]])
  cat("\n")
}

```
```{r}
anova_results <- lapply(numeric_columns, function(column) {
  formula <- as.formula(paste(column, "~ as.factor(AMItype)")) })
anova_results
```
```{r}
# Load necessary libraries
library(tidyverse)

# Load the dataset
data <- read.csv("dataset_DM.csv")

# Convert "AMI-type" to a factor
data$AMItype <- as.factor(data$AMItype)
data$Gender <- as.factor(data$Gender)

# Categorize "Age" into specified blocks
data$Age_category <- cut(data$Age,
                         breaks = c(-Inf, 40, 65, Inf),
                         labels = c("Young", "Middle", "Old"),
                         right = FALSE)

# Display the structure of the modified data
str(data)

# Save the modified dataset to a new CSV file
```


```{r}
write.csv(data, "modified_dataset_DM.csv", row.names = FALSE)

```

```{r}
sd(data$Gender, na.rm = TRUE)

```
```{r}
# Load necessary libraries
library(readr)
library(dplyr)

# Load the dataset
file_path <- "modified_dataset_DM.csv"
data <- read_csv(file_path)

# Convert Gender to a factor if it is not already
data$Gender  <- as.factor(data$Gender)

data$Age_category <- as.factor(data$Age_category)

data1 <- data

# List of categorical variables
categorical_vars <- names(data)[sapply(data, is.factor)]


# If there are no categorical variables in the dataset, convert the ones you need to factors manually
# For the sake of example, assuming 'AMItype' is categorical
data$AMItype <- as.factor(data$AMItype)

# Perform chi-square test for each categorical variable against Gender
results <- lapply(categorical_vars, function(var) {
  tbl <- table(data$Gender, data[[var]])
  chisq.test(tbl)
})

# Display the results
results

```

```{r}
categorical_vars
```
```{r}
# Load necessary libraries
library(ggplot2)
library(reshape2)

# Load your dataset
data <- read.csv("HeartAttack.csv")

# Select only numerical columns for plotting
numerical_data <- data[, sapply(data, is.numeric)]

# Reshape the data for faceted plotting
data_melt <- melt(numerical_data)

# Create faceted box plots
ggplot(data_melt, aes(x = variable, y = value)) +
  geom_boxplot() +
  facet_wrap(~ variable, scales = "free_y", ncol = 1) +
  theme(
    axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
    panel.grid.major = element_blank(),
    panel.grid.minor = element_blank(),
    panel.background = element_blank()
  ) +
  xlab("Variables") +
  ylab("Values") +
  ggtitle("Faceted Box Plots for Numerical Features") + 
  theme_minimal()



```


